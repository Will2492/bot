<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>TON Premium и Stars</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- TON Connect SDK -->
  <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: white;
      text-align: center;
      padding: 30px 15px;
    }

    button {
      background: #00bfa5;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
      margin: 10px;
    }

    input {
      background: #1f1f1f;
      border: 1px solid #444;
      color: white;
      padding: 10px;
      border-radius: 5px;
      width: 260px;
      margin: 8px;
    }

    code {
      background: #1c1c1c;
      padding: 6px 10px;
      border-radius: 4px;
      display: inline-block;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h1>Купить Telegram Premium и Stars через TON</h1>

  <!-- Кнопка подключения -->
  <button onclick="connectTON()">Подключить кошелёк</button>
  <div id="wallet-address"></div>

  <!-- Покупка Premium -->
  <button onclick="buyPremium()">Купить Telegram Premium</button>

  <!-- Покупка Stars -->
  <h2>Купить Telegram Stars</h2>
  <input type="text" id="stars-username" placeholder="@ваш_телеграм">
  <input type="number" id="stars-amount" placeholder="Количество Stars">
  <br>
  <button onclick="buyStars()">Купить Stars</button>

  <!-- Реферальная ссылка -->
  <p>Ваша реферальная ссылка:</p>
  <code id="ref-link">—</code>

  <script>
    // Инициализация TON Connect
    <script src="https://unpkg.com/@tonconnect/sdk@latest">
  </script>
      manifestUrl: 'https://yourdomain.com/tonconnect-manifest.json' // ← замените на ваш URL!
    });

    let userWallet = null;
    const receiverAddress = "EQCXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"; // ← ваш TON адрес

    async function connectTON() {
      try {
        await tonConnect.restoreConnection();

        const wallet = await tonConnect.connectWallet();
        userWallet = wallet.account.address;

        document.getElementById("wallet-address").innerText = "Кошелёк: " + userWallet;
        document.getElementById("ref-link").innerText = window.location.origin + "?ref=" + userWallet;
      } catch (err) {
        alert("Ошибка подключения: " + err.message);
      }
    }

    function buyPremium() {
      if (!userWallet) return alert("Сначала подключите кошелёк");
      const amountTON = 3;
      const comment = "Telegram Premium";
      window.location.href = `ton://transfer/${receiverAddress}?amount=${amountTON * 1e9}&text=${encodeURIComponent(comment)}`;
    }

    function buyStars() {
      if (!userWallet) return alert("Сначала подключите кошелёк");

      const username = document.getElementById("stars-username").value.trim();
      const amount = parseInt(document.getElementById("stars-amount").value);
      if (!username || !amount || amount <= 0) {
        alert("Введите корректные данные");
        return;
      }

      const pricePerStar = 0.03;
      const total = (pricePerStar * amount).toFixed(3);
      const comment = `Telegram Stars для ${username}, ${amount} шт.`;

      window.location.href = `ton://transfer/${receiverAddress}?amount=${total * 1e9}&text=${encodeURIComponent(comment)}`;
    }
  </script>

</body>
</html>